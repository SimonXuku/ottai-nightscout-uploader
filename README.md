# Nightscout Ottai CGM Uploader
Скрипт написан на Python для периодической отправки данных о  глюкозе от фолловера ottai в Nightscout.

* Протестировано на Российских датчиках ottai в белой коробке

Конфигурация
Скрипт использует следующие переменные окружения

| Переменная               | Описание                                                                                                                | пример                                  | Необходим |
|--------------------------|----------------------------------------------------------------------------------------------------------------------------|------------------------------------------|----------|
| OTTAI_TOKEN                | Ottai API JWT токен Token                                                                                                 | eyJhbGciOiJIUzUxMiJ9.eyJleHAiOjE3NDQyODUzMzcsInVzZXJJZCI6IjIwMTEyMzQ1In0.qGMRGHFi7EKhDvsYQ2wfc1mL_efuFDqjcG1_wE_e5NQbuK1zx7CCvtEQHlIUKrq54pPL0AQ-rn_bB0t5Yzx1xg     | X        |
| NS_URL                | URL адрес Nightscout                                                                                                   | https://j12345678.nightscout-jino.ru/                                       |     X     |
| NS_API_SECRET       | API Secret NightScout      | H4uSur24Bkwu                                       |      X    |
| HOURS_AGO    | Перезапуск перевыгрузки данных при потере связи в часах                                                               | 5                                        |    X      |


## Получение Ottai API JWT токен 
Выберите поделиться на телефоне мастера и введите адрес почты фолловера

*Нельзя быть самому себе мастером и фолловером. Адреса почт должны отличаться!*
Зарегистрируйтесь и запустите приложение Ottai Share на мобильном телефоне.

Установите приложение для захвата пакетов на свой мобильный телефон. например. Захват HTTP-трафика для iOS. PCAPdroid для Android.
Установите необходимый сертификат согласно инструкции приложения для захвата пакетов.
Сканируйте приложение Ottai Share.
В заголовке запроса найдите authorization:«...» — это ваш OTTAI_TOKEN.
Если приложение Ottai переустанавливается или выполняется повторная процедура входа на том же устройстве - вам придется повторить описанный выше шаг. Токен выдается на полгода, в течении этого времени он не должен меняться
